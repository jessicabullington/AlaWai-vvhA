---
title: "Visual_heatplots"
author: "Jessica Bullington"
date: "5/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Clear workspace
```{r}
rm(list=ls()) # clear environment
```

### Load the data
```{r}
rm(list=ls()) # clear workspace
data = read.csv("AlaWai_DiscreteBottle.csv") # first drag/drop in repo on github website
data = subset(data, !is.na(data$vvhA)) # keep only rows with observations for vvhA
data$vvhA = as.numeric(data$vvhA) # change the class type to numeric
```

### Transformations
```{r}
# make a new column for each transformation
data$tran.vvhA = (data$vvhA)^(1/4)
data$tran.TN = log10(data$TotalN+1)
data$tran.TP = (data$TotalP)^(1/3)
data$tran.Si = (data$Si)^(1/3)
# N+N?
data$tran.DOC = log10(data$DOC+1)
data$tran.POC = log10(data$POC+1)
# FCM?
data$tran.Sal = (data$Salinity^4)/10000 # dividing by 10000 removes the scaling issue with lm
data$tran.Temp = data$Temperature
data$tran.Turb = log10(data$Turbidity+1)
data$tran.Chl = (data$Chlorophyll)^(1/4)
# Depth?
```

### Heatplots separated by month

#### vvhA heatplot
```{r}
library(ggplot2)
ggplot(data, aes(x = Date, y = Abundance, fill = Phylum)) + 
  facet_grid(Station~.) +
  geom_tile()


heatmap.SAR324.het.log <- ggplot(data = df.sarh10, aes(x = Clade, y = Sample)) +
  geom_tile(aes(fill = RelAbund)) +
  scale_fill_viridis(name = "log10 Percent Abundance", na.value = 'white', option="inferno", direction = -1,
                     limits = c(0,1.5),breaks = c(0.5, 1.0, 1.5))  +
  scale_y_discrete(position = "right") +
  xlab("SAR324") +
  theme(axis.text.y = element_blank(), axis.title.y = element_blank(),
        legend.position = "top", axis.ticks = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.text.x = element_text(size = 10, angle = 90, hjust = 1, vjust=0.2))
```

### Dendrogram
```{r}
# z-score noraml data


```

